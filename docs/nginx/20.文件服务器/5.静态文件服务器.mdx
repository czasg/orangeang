---
title: é™æ€æ–‡ä»¶æœåŠ¡å™¨
hide_title: false
hide_table_of_contents: false
slug: /file-server/static-file-server
---

import FullScreenImage from '@site/src/components/FullScreenImage';
import BrowserWindow from '@site/src/components/BrowserWindow';
import EmptyLine from '@site/src/components/EmptyLine';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

<!--package-->

Nginx æ­å»ºé™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼Œé€šå¸¸ä½¿ç”¨`root`æˆ–è€…`alias`æŒ‡ä»¤ã€‚

æ­¤å¤–è¿˜éœ€è¦æŒ‡å®šä¸€ä¸ªç›®å½•ä½œä¸ºé™æ€æ–‡ä»¶å­˜å‚¨è·¯å¾„é…ç½®ã€‚æˆ‘ä»¬å…ˆå‡è®¾æœ‰ä»¥ä¸‹ç›®å½•ç»“æ„ï¼š

```text
/static
  â”œâ”€â”€ css
  â”‚   â””â”€â”€ custom.css
  â”œâ”€â”€ js
  â”‚   â”œâ”€â”€ main.js
  â”‚   â””â”€â”€ custom.js
  â”œâ”€â”€ unknown.html
  â”œâ”€â”€ notfound.html
  â””â”€â”€ index.html
```

åœ¨è¿™ä¸ªç›®å½•ç»“æ„ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ ¹ç›®å½•`/static`ä¸‹é¢å­˜æ”¾äº†`html`ã€`js`ã€`css`ç­‰æ–‡ä»¶ã€‚ä¸ºäº†åç»­æ–¹ä¾¿ç†è§£ï¼Œæˆ‘ä»¬å‡è®¾æ¯ä¸ªæ–‡ä»¶çš„å†…å®¹å°±æ˜¯æ–‡ä»¶è‡ªèº«çš„è¯¦ç»†è·¯å¾„~ï¼ˆå³æ–‡ä»¶`custom.css`å†…å®¹ä¸º`/static/css/custom.css`ï¼‰

è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å‡†å¤‡ nginx é…ç½®æ–‡ä»¶äº†ã€‚

## root

åœ¨ nginx ä¸­ï¼Œ`root`å…³é”®å­—å¯ä»¥æŒ‡å®šä¸€ä¸ªç›®å½•ä½œä¸ºé™æ€æ–‡ä»¶å­˜å‚¨è·¯å¾„é…ç½®ã€‚

å½“è¯·æ±‚å‘½ä¸­è·¯ç”±è§„åˆ™æ—¶ï¼Œä¼šå°†**è·¯å¾„æ‹¼æ¥åœ¨`root`è·¯å¾„ä¹‹åå»æŸ¥æ‰¾æ–‡ä»¶ï¼**

å…¶è¯­æ³•ç»“æ„ä¸ºï¼š

```text
root   dir;
```

ä¸ºäº†æ›´å¥½çš„ç†è§£`root`çš„ä½œç”¨ï¼Œæˆ‘ä»¬å‡è®¾å®šä¹‰äº†å¦‚ä¸‹çš„è·¯ç”±è§„åˆ™ï¼š

```yaml
location / {
    root   /static;
}
```

å½“è¯·æ±‚è·¯å¾„ä¸º`/static/css/custom.css`æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç° nginx æŸ¥æ‰¾æ–‡ä»¶çš„è·¯å¾„ä¸º`/static/static/css/custom.css`ï¼

å› æ­¤è¯¥è¯·æ±‚æ— æ³•æ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶ï¼

æ‰€ä»¥æˆ‘ä»¬éœ€è¦è°ƒæ•´è¯·æ±‚è·¯å¾„ä¸º`/css/custom.css`ï¼Œè¿™æ—¶ nginx å°±å¯ä»¥æ­£ç¡®å‘½ä¸­`/static/css/custom.css`æ–‡ä»¶ã€‚

å¤§è‡´äº†è§£`root`çš„åŸç†ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å‡†å¤‡ nginx é…ç½®æ–‡ä»¶ã€‚

### 1. å‡†å¤‡é…ç½®æ–‡ä»¶

```yaml title="/conf/root.conf"
server {
    listen       80;
    server_name  _;

    # é™æ€æ–‡ä»¶æœåŠ¡å™¨
    location /static {
        # æŒ‡å®šæ ¹ç›®å½•
        root   /;
        # æŒ‡å®šé»˜è®¤è¿”å›çš„æ–‡ä»¶
        index  index.html;
    }
    # æ–‡ä»¶ä¸å­˜åœ¨
    error_page  404  /static/notfound.html;
}
```

åœ¨ä¸Šè¿°é…ç½®ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª`location /static`è§„åˆ™ï¼Œå®ƒè¡¨ç¤ºæ‰€æœ‰ä»¥`/static`å¼€å¤´çš„è¯·æ±‚éƒ½ä¼šå‘½ä¸­æ­¤è§„åˆ™ã€‚å¹¶ä¸”è§„åˆ™ä¸­æŒ‡å®šäº†æ ¹ç›®å½•ä¸º`/`ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†æ­¤ç›®å½•æ˜ å°„åˆ°é™æ€æ–‡ä»¶æœåŠ¡å™¨ä¸­äº†ã€‚

:::note è¡¥å……
error_page å¯ä»¥æ£€æµ‹å“åº”çš„é”™è¯¯ç ï¼Œä»è€Œå®ç°å†…éƒ¨è½¬å‘èƒ½åŠ›ã€‚
:::

### 2. å¯åŠ¨æœåŠ¡

```bash
$ docker run -it --rm -p 80:80 \
    -v /conf/root.conf:/etc/nginx/conf.d/default.conf \
    -v /static:/static \
    nginx
```

### 3. éªŒè¯åŠŸèƒ½

é€šè¿‡æµè§ˆå™¨è®¿é—®`http://localhost/static/` ï¼Œå¦‚æœå¯ä»¥çœ‹åˆ°`index.html`é¡µé¢ï¼Œé‚£å°±è¯´æ˜è§„åˆ™å·²ç»ç”Ÿæ•ˆã€‚

<BrowserWindow url="http://localhost/static/">

/static/index.html

</BrowserWindow>

é€šè¿‡æµè§ˆå™¨è®¿é—®`http://localhost/static/css/custom.css` ï¼Œå¦‚æœå¯ä»¥çœ‹åˆ°`custom.css`é¡µé¢ï¼Œé‚£å°±è¯´æ˜è§„åˆ™å·²ç»ç”Ÿæ•ˆã€‚

<BrowserWindow url="http://localhost/static/css/custom.css">

/static/css/custom.css

</BrowserWindow>

é€šè¿‡æµè§ˆå™¨è®¿é—®`http://localhost/static/123` ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„é¡µé¢ï¼Œè¿™æ—¶æˆ‘ä»¬å¦‚æœå¯ä»¥çœ‹åˆ°`notfound.html`é¡µé¢ï¼Œé‚£å°±è¯´æ˜è§„åˆ™`error_page`å·²ç»ç”Ÿæ•ˆã€‚

<BrowserWindow url="http://localhost/static/123">

/static/notfound.html

</BrowserWindow>

æ­¤æ—¶`notfound.html`é¡µé¢çš„æŸ¥æ‰¾é€»è¾‘ä¸ºï¼š

- è¯·æ±‚`/static/123`è¿”å›`404`ä¸å­˜åœ¨
- è§„åˆ™`error_page`æ¢æµ‹åˆ°`404`ä»è€Œè½¬å‘åˆ°`/static/notfound.html`
- è¯·æ±‚`/static/notfound.html`å¹¶è¿”å›é¡µé¢

æ­¤æ—¶ç”¨æˆ·çœ‹åˆ°çš„å°±æ˜¯`notfound.html`é¡µé¢ï¼Œä¸”çŠ¶æ€ç ä»æ—§æ˜¯`404`~~










## alias

åœ¨ nginx ä¸­ï¼Œ`alias`å’Œ`root`ä¸€æ ·å¯ä»¥æŒ‡å®šæœåŠ¡å™¨ä¸Šé™æ€æ–‡ä»¶çš„æ ¹ç›®å½•ã€‚

ä½†ä»–ä»¬ä¹‹é—´æœ‰ä¸€äº›ç»†å¾®çš„å·®åˆ«ï¼Œå‰è€…**ä¸ä¼šæ‹¼æ¥è¯·æ±‚è·¯å¾„**ï¼Œè€Œåè€…ä¼š**æ‹¼æ¥è¯·æ±‚è·¯å¾„**ï¼

å…¶è¯­æ³•ç»“æ„åŒæ ·ä¸ºï¼š

```text
alias   dir;
```

ä¸ºäº†æ›´å¥½çš„ç†è§£`alias`çš„ä½œç”¨ï¼Œæˆ‘ä»¬å‡è®¾æœ‰å¦‚ä¸‹çš„è·¯ç”±è§„åˆ™ï¼š

```yaml
location / {
    alias   /static;
}
```

å½“è¯·æ±‚è·¯å¾„ä¸º`/static/css/custom.css`æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç° nginx æŸ¥æ‰¾æ–‡ä»¶çš„è·¯å¾„ä¸º`/static/css/custom.css`ï¼

è¿™æ­£å¥½å¯ä»¥æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶ï¼

è€ŒåŒæ ·çš„è¯·æ±‚åœ¨`root`æŒ‡ä»¤ä¸‹åˆ™ä¼šå‘½ä¸­`/static/static/css/custom.css`!

å¤§è‡´äº†è§£`alias`å’Œ`root`åŒºåˆ«ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å‡†å¤‡ nginx é…ç½®æ–‡ä»¶ã€‚

### 1. å‡†å¤‡é…ç½®æ–‡ä»¶

```yaml title="/conf/alias.conf"
server {
    listen       80;
    server_name  _;

    # é™æ€æ–‡ä»¶æœåŠ¡å™¨
    location /static {
        # æŒ‡å®šæ ¹ç›®å½•
        alias   /static;
        # æŒ‡å®šé»˜è®¤è¿”å›çš„æ–‡ä»¶
        index  index.html;
    }
    # æ–‡ä»¶ä¸å­˜åœ¨
    error_page  404  /static/notfound.html;
}
```

åœ¨ä¸Šè¿°é…ç½®ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª`location /static`è§„åˆ™ï¼Œå®ƒè¡¨ç¤ºæ‰€æœ‰ä»¥`/static`å¼€å¤´çš„è¯·æ±‚éƒ½ä¼šå‘½ä¸­æ­¤è§„åˆ™ã€‚å¹¶ä¸”è§„åˆ™ä¸­æŒ‡å®šäº†æ ¹ç›®å½•ä¸º`/static`ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†æ­¤ç›®å½•æ˜ å°„åˆ°é™æ€æ–‡ä»¶æœåŠ¡å™¨ä¸­äº†ã€‚

### 2. å¯åŠ¨æœåŠ¡

```bash
$ docker run -it --rm -p 80:80 \
    -v /conf/alias.conf:/etc/nginx/conf.d/default.conf \
    -v /static:/static \
    nginx
```

### 3. éªŒè¯åŠŸèƒ½

é€šè¿‡æµè§ˆå™¨è®¿é—®`http://localhost/static/` ï¼Œå¦‚æœå¯ä»¥çœ‹åˆ°`index.html`é¡µé¢ï¼Œé‚£å°±è¯´æ˜è§„åˆ™å·²ç»ç”Ÿæ•ˆã€‚

<BrowserWindow url="http://localhost/static/">

    /static/index.html

</BrowserWindow>

é€šè¿‡æµè§ˆå™¨è®¿é—®`http://localhost/static/css/custom.css` ï¼Œå¦‚æœå¯ä»¥çœ‹åˆ°`custom.css`é¡µé¢ï¼Œé‚£å°±è¯´æ˜è§„åˆ™å·²ç»ç”Ÿæ•ˆã€‚

<BrowserWindow url="http://localhost/static/css/custom.css">

    /static/css/custom.css

</BrowserWindow>

:::tip æç¤º

ç»†å¿ƒçš„åŒå­¦å¯èƒ½å·²ç»å‘ç°`root`å’Œ`alias`ç¤ºä¾‹ä¸­åªæœ‰**æ ¹ç›®å½•é…ç½®**ä¸åŒ~ğŸ˜ğŸ˜ğŸ˜

:::






## autoindex

åœ¨ Nginx ä¸­ï¼Œ`autoindex`æŒ‡ä»¤ç”¨äºå¯åŠ¨æˆ–ç¦æ­¢ç›®å½•åˆ—è¡¨åŠŸèƒ½ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬å¯åŠ¨äº†`autoindex`ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªåœ¨çº¿æ–‡ä»¶æµè§ˆåŠŸèƒ½ã€‚è¿™åœ¨è°ƒè¯•å’Œå¼€å‘è¿‡ç¨‹ä¸­éå¸¸æœ‰ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨äºæä¾›æ–‡ä»¶ä¸‹è½½æœåŠ¡ã€‚

é€šå¸¸æ¥è®²ï¼Œ`autoindex`æŒ‡ä»¤å¯ä»¥åœ¨ `http`ã€`server`ã€`location` å—ä¸­ä½¿ç”¨ã€‚å…¶è¯­æ³•ç»“æ„ä¸ºï¼š

```text
autoindex   on | off;
```

ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹æ¥å¿«é€Ÿç†Ÿæ‚‰`autoindex`åŠŸèƒ½~

### 1.å‡†å¤‡é…ç½®æ–‡ä»¶

```yaml title="/conf/autoindex.conf"
server {
    listen 80;
    server_name _;

    location / {
        root      /static/;
        autoindex on;
        # ä¸æŒ‡å®šé»˜è®¤è¿”å›æ–‡ä»¶
        index     _;
    }
}
```

åœ¨ä¸Šè¿°é…ç½®ä¸­ï¼Œæˆ‘ä»¬åœ¨`location`ä¸­æŒ‡å®šäº†`autoindex on;`ï¼Œè¡¨ç¤ºå¯ç”¨ç›®å½•åˆ—è¡¨åŠŸèƒ½ã€‚æ¥ç€æˆ‘ä»¬å¯åŠ¨æœåŠ¡ã€‚

### 2.å¯åŠ¨æœåŠ¡

```bash
$ docker run -it --rm -p 80:80 \
    -v /conf/autoindex.conf:/etc/nginx/conf.d/default.conf \
    -v /static:/static \
    nginx
```

### 3.éªŒè¯åŠŸèƒ½

é€šè¿‡æµè§ˆå™¨è®¿é—®`http://localhost/` ï¼Œå¦‚æœå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç±»ä¼¼çš„åˆ—è¡¨é¡µé¢ï¼Œé‚£å°±è¯´æ˜è§„åˆ™å·²ç»ç”Ÿæ•ˆã€‚

<BrowserWindow url="http://localhost/">

<h4>Index of /</h4>

<pre>
<a href="#">../</a>
<a href="#">css/</a>                             14-May-2024 07:46                   -
<a href="#">js/</a>                              14-May-2024 07:46                   -
<a href="#">index.html</a>                       14-May-2024 07:47                  18
<a href="#">notfound.html</a>                    14-May-2024 07:47                  21
<a href="#">unknown.html</a>                     14-May-2024 07:46                  20
</pre>

</BrowserWindow>

<br/>

:::info ğŸ‘‡ğŸ‘‡ğŸ‘‡
**æœ¬æ–‡ä½œè€…:** æ©™å­æ˜‚ <br/>
**ç‰ˆæƒå£°æ˜:** è½¬è½½è¯·æ³¨æ˜å‡ºå¤„å“¦~ğŸ‘®â€ğŸ‘®â€ğŸ‘®â€
:::

